---
import Layout from '../layouts/Layout.astro';
import { getCollection } from 'astro:content';

const posts = await getCollection('blog');
// Sort posts by date (newest first)
posts.sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());
---

<Layout title="Uliboooo">
	<header class="navbar">
		<a href="/" class="logo">
			<img src="/resource/logo.webp" alt="Uliboooo Logo" height="32" />
			<span>Uliboooo</span>
		</a>

		<nav class="tab-nav">
			<button class="tab-btn active" data-target="about">About Me</button>
			<button class="tab-btn" data-target="repos">Repositories</button>
			<button class="tab-btn" data-target="articles">Articles</button>
			<button class="tab-btn" data-target="blogs">Blogs</button>
		</nav>

		<div class="header-right">
			<div class="social-links">
				<a href="https://github.com/Uliboooo" target="_blank" aria-label="GitHub">
					<img src="/resource/icons/github.svg" alt="GitHub" />
				</a>
				<a href="https://x.com/Uliboooo" target="_blank" aria-label="X (Twitter)">
					<img src="/resource/icons/x.svg" alt="X" />
				</a>
				<a href="https://zenn.dev/uliboooo" target="_blank" aria-label="Zenn">
					<img src="/resource/icons/zenn_logo.svg" alt="Zenn" class="no-invert" />
				</a>
				<a href="https://note.com/uliboooo" target="_blank" aria-label="Note">
					<img src="/resource/icons/note.png" alt="Note" class="no-invert" />
				</a>
			</div>
			<button id="theme-toggle" class="theme-btn">Dark</button>
		</div>
	</header>

	<main class="container">
		<!-- About Tab -->
		<section id="about" class="tab-pane active">
			<div class="card about-card">
				<h2>About Me</h2>
				<p>ソフトウェアと文字が好きな大学生。oは4つです。</p>
				<p>RustでCLIツールなどを開発しています。エディタはVim派です。</p>
				<br />
				<p>I am a university student who loves software and text. (My name has four 'o's).</p>
				<p>I develop CLI tools mainly using Rust. I'm a Vimmer.</p>
			</div>

			<div class="card about-card">
				<h2>Projects</h2>
				<p>私が参加しているプロジェクトです。</p>
				<p>These are the projects I participate in.</p>

				<div>
					<h3>CraBWave_FM</h3>
					<p>まだ準備中のプロジェクトですがスピーカーとして出演予定です。</p>
					<br />
					<p>This project is currently in preparation, and I plan to participate as a speaker.</p>
					<blockquote cite="https://crabwave.rioze.dev/">
						<p>
							CrabWaveはソフトウェアの開発と研究について語り合う4人の大学生によるプロジェクトです。
							浅瀬のような軽い話題からコアな話題までラジオとブログで発信しています。
						</p>
						<br />
						<p>
							CrabWave is a project by four university students discussing software development and research. We
							broadcast topics ranging from light shallow discussions to core technical topics via radio and blog.
						</p>
						<cite><a href="https://crabwave.rioze.dev/" target="_blank">Source: CrabWave</a></cite>
					</blockquote>
				</div>
			</div>
		</section>

		<!-- Repositories Tab -->
		<section id="repos" class="tab-pane">
			<div class="grid">
				<div class="card repo-card">
					<h3>ghost_git_writer</h3>
					<div class="links">
						<a href="https://github.com/Uliboooo/ghost_git_writer" target="_blank">GitHub</a>
						<a href="https://uliboooo.github.io/ghost_git_writer" target="_blank">Home</a>
					</div>
					<p>LLMでGitコミットメッセージ、README、または差分要約を作成するツール。</p>
				</div>

				<div class="card repo-card">
					<h3>track2line</h3>
					<div class="links">
						<a href="https://github.com/Uliboooo/track2line" target="_blank">GitHub</a>
					</div>
					<p>VoiSona Talk などから出力された音声ファイルの名前を、台詞テキストを参照して一括変換するツール。</p>
				</div>

				<div class="card repo-card">
					<h3>dotfiles</h3>
					<div class="links">
						<a href="https://github.com/Uliboooo/dotfiles" target="_blank">GitHub</a>
					</div>
					<p>私のCLI系の設定ファイル一覧。Neovimなどの設定も管理しています。</p>
				</div>

				<div class="card repo-card">
					<h3>Ramifi</h3>
					<div class="links">
						<a href="https://github.com/Uliboooo/ramifi" target="_blank">GitHub</a>
					</div>
					<p>
						GithubのissuesページのようなGUIノートアプリ。eGUIをgeminiによって実装。自作lib(local_issues_lib)にコア機能を依存している。
					</p>
				</div>

				<div class="card repo-card">
					<h3>local_issues_lib</h3>
					<div class="links">
						<a href="https://github.com/Uliboooo/local_issues_lib" target="_blank">GitHub</a>
					</div>
					<p>
						ローカルの課題を管理するための機能を提供し、GitHubの課題管理に似ていますが、ローカルでの使用に特化しています。
					</p>
				</div>

				<div class="card repo-card">
					<h3>polish_notation</h3>
					<div class="links">
						<a href="https://github.com/Uliboooo/polish_notation" target="_blank">GitHub</a>
					</div>
					<p>Rustで再帰関数を用いたポーランド記法電卓。</p>
				</div>

				<div class="card repo-card">
					<h3>fibonacci_py</h3>
					<div class="links">
						<a href="https://github.com/Uliboooo/fibonacci_py" target="_blank">GitHub</a>
					</div>
					<p>フィボナッチ数列をPythonで生成するツール。</p>
				</div>
			</div>
		</section>

		<!-- Articles Tab -->
		<section id="articles" class="tab-pane">
			<div class="list">
				<a href="https://zenn.dev/uliboooo/articles/9f0add249046d9" target="_blank" class="card article-card">
					<span class="tag zenn">Zenn</span>
					<h3>Rustでトレイト境界のような形で変数を束縛する【dyn】</h3>
					<p>実行時に型を決定したい場合のRustのテクニック。</p>
				</a>

				<a href="https://zenn.dev/uliboooo/articles/5bc9ce655c38c9" target="_blank" class="card article-card">
					<span class="tag zenn">Zenn</span>
					<h3>git/gh コマンド。個人的チートシート</h3>
					<p>個人的によく使うからaliasにしてるコマンド群について。</p>
				</a>

				<a href="https://zenn.dev/uliboooo/articles/0f2c0e56e3f1fa" target="_blank" class="card article-card">
					<span class="tag zenn">Zenn</span>
					<h3>serdeのシリアライズ/デシアライズ実例</h3>
					<p>Rustで構造体をserdeライブラリを使ってシリアライズする話。</p>
				</a>

				<a href="https://note.com/uliboooo/m/m6c323899ecf4" target="_blank" class="card article-card">
					<span class="tag note">Note</span>
					<h3>Rustを分りたい</h3>
					<p>Rustに関するnote記事のまとめ。</p>
				</a>

				<a href="https://note.com/uliboooo/n/n7ea272e490f0" target="_blank" class="card article-card">
					<span class="tag note">Note</span>
					<h3>垂直タブバーは贅沢</h3>
					<p>垂直タブの利点と小画面ゆえの悩ましさについて。</p>
				</a>

				<a href="https://note.com/uliboooo/n/nae5ae0da7df4" target="_blank" class="card article-card">
					<span class="tag note">Note</span>
					<h3>fnキーが左にないキーボードをmacで使う</h3>
					<p>キー配置の不便を解決する話。</p>
				</a>
			</div>
		</section>

		<!-- Blogs Tab -->
		<section id="blogs" class="tab-pane">
			<!-- Dynamic Blog List Rendered by Astro -->
			<div class="list" id="blog-list">
				{
					posts.length === 0 ? (
						<div class="card empty-state">
							<h3>No Posts Yet</h3>
						</div>
					) : (
						posts.map((post) => (
							<a href={`/posts/${post.slug}`} class="card article-card">
								<h3>{post.data.title}</h3>
								{post.data.date && (
									<p style="color: var(--text-muted); font-size: 0.85rem; margin-bottom: 0.5rem;">
										{post.data.date.toISOString().split('T')[0]}
									</p>
								)}
								{post.data.description && <p>{post.data.description}</p>}
							</a>
						))
					)
				}
			</div>
		</section>
	</main>

	<script>
		// Tab Switching Logic
		document.addEventListener('DOMContentLoaded', () => {
			const tabs = document.querySelectorAll('.tab-btn');
			const contents = document.querySelectorAll('.tab-pane');

			const switchTab = (targetId) => {
				const activeTab = document.querySelector(`.tab-btn[data-target="${targetId}"]`);
				const activeContent = document.getElementById(targetId);

				if (activeTab && activeContent) {
					tabs.forEach((t) => t.classList.remove('active'));
					contents.forEach((c) => c.classList.remove('active'));

					activeTab.classList.add('active');
					activeContent.classList.add('active');
				}
			};

			tabs.forEach((tab) => {
				tab.addEventListener('click', () => {
					// @ts-ignore
					const targetId = tab.dataset.target;
					switchTab(targetId);
					history.replaceState(null, '', `#${targetId}`);
				});
			});

			// Handle initial hash
			const initialHash = window.location.hash.substring(1);
			if (initialHash) {
				switchTab(initialHash);
			}
		});
	</script>
</Layout>